var MyLibrary=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e){t.exports=jQuery},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(t){var e=this;this.elementBindings=[],this.value=t.object[t.property],this.valueGetter=function(){return e.value},this.valueSetter=function(t){e.value=t;for(var n=0;n<e.elementBindings.length;n++){var i=e.elementBindings[n];i.element[i.attribute]=t}},this.addBinding=function(t,n,i){var r={element:t,attribute:n,event:i};return i&&(t.addEventListener(i,(function(i){e.valueSetter(t[n])})),r.event=i),this.elementBindings.push(r),t[n]=e.value,e},Object.defineProperty(t.object,t.property,{get:this.valueGetter,set:this.valueSetter}),t.object[t.property]=this.value}},function(t,e){t.exports=moment},,,,,,function(t,e,n){"use strict";n.r(e);var i,r,o,s,a=n(0),p=n.n(a),u=n(1);!function(t){t[t.running=0]="running",t[t.paused=1]="paused"}(i||(i={})),function(t){t[t.Starting=0]="Starting",t[t.Running=1]="Running",t[t.MakeItStop=2]="MakeItStop",t[t.StoppingLR=3]="StoppingLR",t[t.StoppingRL=4]="StoppingRL",t[t.Stopped=5]="Stopped"}(r||(r={})),function(t){t[t.Stopped=0]="Stopped",t[t.Running=1]="Running",t[t.Paused=2]="Paused",t[t.StartNext=3]="StartNext",t[t.Settling=4]="Settling"}(o||(o={})),function(t){t[t.stopped=0]="stopped",t[t.starting=1]="starting",t[t.running=2]="running",t[t.stopping_lr=3]="stopping_lr",t[t.stopping_rl=4]="stopping_rl"}(s||(s={}));var c={buttonFace:"▶️",display:"",endWithBell:!0,exerciseDisplay:"",exerciseMarkup:"",pendulumParent:"",rest:3,startWithRest:!0,metronomeState:r[r.Stopped],tempoDisplay:"120",timerDisplay:"2:00"},l=$(".button-face")[0];new u.a({object:c,property:"buttonFace"}).addBinding(l,"innerText");var h=$(".end-with-bell")[0];new u.a({object:c,property:"endWithBell"}).addBinding(h,"checked");var m=$(".exercise-display")[0];new u.a({object:c,property:"exerciseDisplay"}).addBinding(m,"innerHTML");var d=$(".display")[0];new u.a({object:c,property:"tempoDisplay"}).addBinding(d,"innerHTML");var f=$(".timer-display")[0];new u.a({object:c,property:"timerDisplay"}).addBinding(f,"innerText");var g=$(".exercise-markup")[0];new u.a({object:c,property:"exerciseMarkup"}).addBinding(g,"innerHTML");var y=$(".pendulum-parent")[0];new u.a({object:c,property:"metronomeState"}).addBinding(y,"data-metronome-state");var b=$(".rest")[0];new u.a({object:c,property:"rest"}).addBinding(b,"value");var v=$(".start-with-rest")[0];new u.a({object:c,property:"startWithRest"}).addBinding(v,"checked");var S,x,w,R,_=function(){function t(){this._tempo=120,this.pendulumElement=$(".pendulum-parent")[0],this.tempoDisplayElement=$(".display")[0],this._isRunning=!1,this._animationName=s.starting,this._duration="0s",this._animationPlayState=i.paused,this._animationDirection="alternate"}return Object.defineProperty(t.prototype,"tempo",{get:function(){return this._tempo},set:function(e){this._tempo=e,this._tempo<t.MIN_TEMPO?this.isRunning=!1:this.duration=Math.round(6e4/this._tempo).toString()+"ms",this.tempoDisplayElement.innerHTML=this.tempoDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tempoDisplay",{get:function(){return this._tempo>=0?this._tempo.toString():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._isRunning},set:function(e){e!==this._isRunning&&(this._isRunning=e,this.tempo<t.MIN_TEMPO&&(this._isRunning=!1),this.setAnimation())},enumerable:!0,configurable:!0}),t.prototype.setAnimation=function(){this.isRunning&&(this._animationName=s.starting)},Object.defineProperty(t.prototype,"animationName",{get:function(){return this._animationName},set:function(t){t!==this._animationName&&(this._animationName=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},set:function(t){t!==this._duration&&(this._duration=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationPlayState",{get:function(){return this._animationPlayState},set:function(t){t!==this._animationPlayState&&(this._animationPlayState=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationDirection",{get:function(){return this._animationDirection},set:function(t){t!==this._animationDirection&&(this._animationDirection=t)},enumerable:!0,configurable:!0}),t.prototype.setStyle=function(){this.pendulumElement.style.animationDuration=this.duration,this.pendulumElement.style.animationDirection=this.animationDirection,this.pendulumElement.style.animationName=s[this.animationName],this.pendulumElement.style.animationPlayState=i[this.animationPlayState],console.log(this.pendulumElement.style)},t.MIN_TEMPO=20,t.MAX_TEMPO=240,t}(),P=n(2),k=n.n(P),T=function(){function t(t,e,n,i){void 0===i&&(i=120),this.durationSec=0,this.tempo=t,this.tempo2=i,this.duration=e,this.description=n}return Object.defineProperty(t.prototype,"duration",{get:function(){return Math.floor(this.durationSec/60).toString()+":"+("0"+this.durationSec%60).slice(-2)},set:function(t){var e=0,n=t.match(/(\d+):(\d\d)/);if(null!=n?e=60*parseInt(n[1])+parseInt(n[2]):NaN!==Number(t)&&(e=Number(t)),0===e)throw"Invalid time format: "+t;this.durationSec=e},enumerable:!0,configurable:!0}),t}(),M=function(){function t(t,e){this.timeline=[],this.status=o.Stopped,this.exercises=[],this.eggTimer=t,this.metronome=e,this.url=new URL(window.location.href),c.rest=3,c.startWithRest=!0,c.endWithBell=!0,this.parseUrl(),c.exerciseMarkup=this.toHtml()}return t.prototype.CalculateTempo=function(){return this.currentStep.tempo},t.prototype.onPlayPause=function(){switch(this.status){case o.Stopped:try{if((null==this.timeline||0===this.timeline.length)&&(this.parseControls(),this.timeline=this.toTimeline(),0===this.timeline.length))return;this.status=o.StartNext}catch(t){alert(t.Message+t.StackTrace)}break;case o.Paused:this.status=o.Running,this.eggTimer.isRunning=!0,this.metronome.animationPlayState=i.running;break;case o.Running:this.status=o.Paused,this.eggTimer.isRunning=!1,this.metronome.animationPlayState=i.paused}this.update()},t.prototype.createLink=function(){try{this.parseControls();var t=this.toUrl();window.open(t)}catch(t){alert(t.Message+t.StackTrace)}},t.prototype.update=function(){switch(this.status){case o.StartNext:if(this.lastStep=this.currentStep,this.currentStep=this.timeline.shift(),void 0===this.currentStep)throw"currentStep is undefined";c.exerciseDisplay=this.currentStep.description,this.metronome.tempo=this.currentStep.tempo,c.tempoDisplay=this.metronome.tempoDisplay,this.metronome.isRunning=this.metronome.tempo>=_.MIN_TEMPO,this.eggTimer.timeRemaining=k.a.duration(this.currentStep.durationSec,"seconds"),this.eggTimer.isRunning=!0,this.status=o.Running,this.metronome.isRunning&&(c.metronomeState=r[r.Starting],this.metronome.animationName=s.starting,this.metronome.animationPlayState=i.running,this.metronome.setStyle());break;case o.Settling:this.status=o.Running}this.metronome.setStyle()},t.prototype.lineCompleted=function(){if(void 0===this.currentStep)throw"currentStep is undefined";if(this.currentStep.tempo>-1&&(this.metronome.animationPlayState=i.running,c.metronomeState=r[r.MakeItStop]),this.timeline.length>0){if(c.endWithBell&&(-1!=this.currentStep.tempo||this.timeline[0].tempo<_.MIN_TEMPO))$(".audio-end-exercise")[0].play();this.status=o.StartNext,this.update()}else{if(c.endWithBell)$(".audio-end-routine")[0].play();this.metronome.tempo=0,this.eggTimer.isRunning=!1,this.eggTimer.isRunning=!1,this.status=o.Stopped,this.eggTimer.colorBody(),c.exerciseDisplay="Done!"}},t.prototype.parseControls=function(){this.exercises=[];var t=this.getExerciseValues();if(t[0].length!=t[1].length||t[1].length!=t[2].length)throw"Lists are different lengths: "+t[0].length+" "+t[1].length+" "+t[2].length;for(var e=0;e<t[0].length;e++){var n=parseInt(t[0][e]);this.exercises.push(new T(n,t[1][e],t[2][e]))}},t.prototype.parseControl=function(t){var e=this.getExerciseValues(),n=Math.floor(t/3),i=t%3;switch(i){case 0:this.exercises[n].tempo=this.myParseInt(e[i][n]);break;case 1:this.exercises[n].duration=e[i][n];break;case 2:this.exercises[n].description=e[i][n]}},t.prototype.parseUrl=function(){var t=new URL(document.URL).searchParams,e=[],n=[],i=[];if(this.exercises=[],t.has("r")){t.forEach((function(t,r){switch(r){case"r":c.rest=parseInt(t);break;case"s":c.startWithRest="true"===t;break;case"b":c.endWithBell="true"===t;break;case"t":for(var o=0,s=t.split("-");o<s.length;o++){var a=s[o],p=parseInt(a);e.push(p)}break;case"d":for(var u=0,l=t.split("-");u<l.length;u++){a=l[u];var h=parseInt(a);n.push(h)}break;case"e":for(var m=0,d=t.split("-");m<d.length;m++){a=(a=(a=d[m]).replace("%26","&")).replace("%2D","-"),i.push(a)}}}));for(var r=0;r<e.length;r++){var o=new T(e[r],"2:00",i[r]);o.durationSec=n[r],this.exercises.push(o)}}else this.exercises.push(new T(120,"2:00",""))},t.prototype.myParseInt=function(t){return t?parseInt(t):0},t.prototype.toTimeline=function(){var t=[],e=new T(-1,c.rest.toString(),"Resting...");this.exercises.length>0&&c.rest>0&&c.startWithRest&&t.push(e);for(var n=0;n<this.exercises.length;n++)t.push(this.exercises[n]),n<this.exercises.length-1&&c.rest>0&&t.push(e);return t},t.prototype.toUrl=function(){for(var t=[],e=[],n=[],i=0,r=this.exercises;i<r.length;i++){var o=r[i];t.push(o.tempo),e.push(o.durationSec),n.push(o.description)}var s=t.join("-"),a=e.map((function(t){return t.toString()})).join("-"),p=n.map((function(t){return encodeURI(t)})).join("-");return j.replace("{0}",this.url.origin+this.url.pathname).replace("{1}",c.rest.toString()).replace("{2}",c.startWithRest.toString()).replace("{3}",c.endWithBell.toString()).replace("{4}",s).replace("{5}",a).replace("{6}",p)},t.prototype.toHtml=function(){for(var t="",e=0,n=this.exercises;e<n.length;e++){var i=n[e];t=t.concat(D.replace("{0}",i.tempo.toString()).replace("{1}",i.duration).replace("{2}",i.description))}return t},t.prototype.getNewRow=function(){return D.replace("{0}","120").replace("{1}","2:00").replace("{2}","")},t.prototype.appendRow=function(t){this.exercises.splice(t+1,0,new T(120,"2:00",""))},t.prototype.deleteRow=function(t){this.exercises.length>1&&this.exercises.splice(t,1)},t.prototype.getExerciseValues=function(){var t=[],e=[],n=[];return $(".tempo-0").each((function(){t.push(""+$(this).val())})),$(".midpoint-0").each((function(){e.push(""+$(this).val())})),$(".exercise").each((function(){n.push(""+$(this).val())})),[t,e,n]},t}(),j="{0}?r={1}&s={2}&b={3}&t={4}&d={5}&e={6}",D='    <tr>\n        <td>\n            <button type="button" class="btn btn-primary delete-schedule-row">␡</button>\n        </td>\n        <td>\n            <input type="text" class="form-control digit-filter tempo tempo-0" placeholder="Tempo" autocomplete="off" value="{0}" />\n        </td>\n        <td>\n            <input type="text" class="form-control time-filter midpoint midpoint-0" placeholder="Duration" autocomplete="off" value="{1}" />\n        </td>\n        <td>\n            <input type="text" class="form-control exercise" placeholder="Exercise" value="{2}" />\n        </td>\n        <td>\n            <button type="button" class="btn btn-primary add-schedule-row">⎀</button>\n        </td>\n    </tr>',I=(S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return I(e,t),e.prototype.CalculateTempo=function(){var t=k.a.duration(3,"seconds").asMilliseconds(),e=this.eggTimer.targetTime-k.a.now(),n=this.currentStep,i=1e3*n.durationSec;if(i-e<t)return n.tempo;if(e<t)return n.tempo;if(Math.abs(e-i/2)<t)return n.tempo2;if(e>i/2){var r=i/2-2*t,o=n.tempo2-n.tempo,s=i-t-e,a=n.tempo+s*o/r;return Math.floor(a)}r=i/2-2*t,o=n.tempo2-n.tempo,s=i/2-t-e,a=n.tempo2-s*o/r;return Math.floor(a)},e.prototype.parseControls=function(){this.exercises=[];var t=this.getExerciseValues();if(t[0].length!=t[1].length||t[1].length!=t[2].length||t[2].length!=t[3].length)throw"Lists are different lengths: "+t[0].length+" "+t[1].length+" "+t[2].length+"  "+t[3].length;for(var e=0;e<t[0].length;e++){var n=parseInt(t[0][e]),i=parseInt(t[1][e]);this.exercises.push(new T(n,t[2][e],t[3][e],i))}},e.prototype.parseControl=function(t){var e=this.getExerciseValues(),n=Math.floor(t/4),i=t%4;switch(i){case 0:this.exercises[n].tempo=this.myParseInt(e[i][n]);break;case 1:this.exercises[n].tempo2=this.myParseInt(e[i][n]);break;case 2:this.exercises[n].duration=e[i][n];break;case 3:this.exercises[n].description=e[i][n]}},e.prototype.parseUrl=function(){var t=new URL(document.URL).searchParams,e=[],n=[],i=[],r=[];if(this.exercises=[],t.has("r")){t.forEach((function(t,o){switch(o){case"r":c.rest=parseInt(t);break;case"s":c.startWithRest="true"===t;break;case"b":c.endWithBell="true"===t;break;case"l":for(var s=0,a=t.split("-");s<a.length;s++){var p=a[s],u=parseInt(p);e.push(u)}break;case"h":for(var l=0,h=t.split("-");l<h.length;l++){p=h[l],u=parseInt(p);n.push(u)}break;case"d":for(var m=0,d=t.split("-");m<d.length;m++){p=d[m];var f=parseInt(p);i.push(f)}break;case"e":for(var g=0,y=t.split("-");g<y.length;g++){p=(p=(p=y[g]).replace("%26","&")).replace("%2D","-"),r.push(p)}}}));for(var o=0;o<e.length;o++){var s=new T(e[o],"2:00",r[o],n[o]);s.durationSec=i[o],this.exercises.push(s)}}else this.exercises.push(new T(60,"2:00","",120))},e.prototype.toUrl=function(){for(var t=[],e=[],n=[],i=[],r=0,o=this.exercises;r<o.length;r++){var s=o[r];t.push(s.tempo),e.push(s.tempo2),n.push(s.durationSec),i.push(s.description)}var a=t.join("-"),p=e.join("-"),u=n.map((function(t){return t.toString()})).join("-"),l=i.map((function(t){return encodeURI(t)})).join("-");return N.replace("{0}",this.url.origin+this.url.pathname).replace("{1}",c.rest.toString()).replace("{2}",c.startWithRest.toString()).replace("{3}",c.endWithBell.toString()).replace("{4}",a).replace("{5}",p).replace("{6}",u).replace("{7}",l)},e.prototype.toHtml=function(){for(var t="",e=0,n=this.exercises;e<n.length;e++){var i=n[e];t=t.concat(B.replace("{0}",i.tempo.toString()).replace("{1}",i.tempo2.toString()).replace("{2}",i.duration).replace("{3}",i.description))}return t},e.prototype.getNewRow=function(){return B.replace("{0}","60").replace("{1}","120").replace("{2}","2:00").replace("{3}","")},e.prototype.appendRow=function(t){this.exercises.splice(t+1,0,new T(60,"2:00","",120))},e.prototype.deleteRow=function(t){this.exercises.length>1&&this.exercises.splice(t,1)},e.prototype.getExerciseValues=function(){var t=[],e=[],n=[],i=[];return $(".tempo-0").each((function(){t.push(""+$(this).val())})),$(".tempo-1").each((function(){e.push(""+$(this).val())})),$(".midpoint-0").each((function(){n.push(""+$(this).val())})),$(".exercise").each((function(){i.push(""+$(this).val())})),[t,e,n,i]},e}(M),N="{0}?r={1}&s={2}&b={3}&l={4}&h={5}&d={6}&e={7}",B="    <tr>\n        <td>\n            <button type=\"button\" class=\"btn btn-primary delete-schedule-row\">␡</button>\n        </td>\n        <td>\n            <input type='text' class='form-control digit-filter tempo tempo-0' placeholder='Tempo 1' autocomplete='off' value='{0}' />\n        </td>\n        <td>\n            <input type='text' class='form-control digit-filter tempo tempo-1' placeholder='Tempo 2' autocomplete='off' value='{1}' />\n        </td>\n        <td>\n            <input type='text' class='form-control time-filter midpoint midpoint-0' placeholder='Duration' autocomplete='off' value='{2}' />\n        </td>\n        <td>\n            <input type='text' class='form-control exercise' placeholder='Exercise' value='{3}' />\n        </td>\n        <td>\n            <button type=\"button\" class=\"btn btn-primary add-schedule-row\">⎀</button>\n        </td>\n    </tr>",O=function(){function t(){this.timeRemaining=k.a.duration(2,"minutes"),this.targetTime=k.a.now(),this.timerDisplay="2:00",this.stateHasChanged=function(){},this.onTimerTick=function(){},this.onTimerExpired=function(){},this.timer=setInterval((function(){}),999999),this._isRunning=!1}return Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._isRunning},set:function(t){this._isRunning=t,this._isRunning?(c.buttonFace="⏸",this.start()):(c.buttonFace="▶️",clearInterval(this.timer))},enumerable:!0,configurable:!0}),t.prototype.initialize=function(t,e){this.onTimerTick=t,this.onTimerExpired=e},t.prototype.roundAndTrimDuration=function(t){var e=Math.max(t.asMilliseconds(),0),n=1e3*Math.round(e/1e3),i=k.a.duration(n,"ms"),r=k.a.utc(i.asMilliseconds()).format("HH:mm:ss"),o=0;for(o=0;o<r.length-4&&("0"==r[o]||":"==r[o]);o++);return r.substring(o)},t.prototype.start=function(){var t=this;this.targetTime=k.a.now()+this.timeRemaining.asMilliseconds(),this.uncolorBody(),c.timerDisplay=this.roundAndTrimDuration(this.timeRemaining),this.timer=setInterval((function(){return t.onTimer()}),1e3)},t.prototype.onTimer=function(){this.timeRemaining=k.a.duration(this.targetTime-k.a.now(),"ms"),c.timerDisplay=this.roundAndTrimDuration(this.timeRemaining),document.title=c.timerDisplay,"0:00"==c.timerDisplay&&this.timerExpired()},t.prototype.colorBody=function(){p()("body").css({"background-color":"#001912",color:"#009871"})},t.prototype.uncolorBody=function(){p()("body").css({"background-color":"",color:""})},t.prototype.timerExpired=function(){this.targetTime=k.a.now(),clearInterval(this.timer),this.onTimerExpired()},t}();p()(document).ready((function(){var t,e,n,o,a,u=window;R=new O,w=new _,x=u.accelerating?new E(R,w):new M(R,w),R.initialize((function(){x.update()}),(function(){x.lineCompleted()})),u.onPlayPause=function(){x.onPlayPause()},u.createLink=function(){x.createLink()},t=w,e=".audio-click",n=1,o=p()(".pendulum-parent"),a=p()(e)[0],o.on("animationstart",(function(){t.isRunning&&a.play()})),o.on("animationiteration",(function(){switch(c.metronomeState){case r[r.Starting]:n=1,t.animationName=s.running,c.metronomeState=r[r.Running];break;case r[r.Running]:a.play(),t.tempo=x.CalculateTempo(),n=(n+1)%2,t.animationDirection=n?"normal":"reverse";break;case r[r.MakeItStop]:n?(t.animationName=s.stopping_rl,c.metronomeState=r[r.StoppingRL]):(t.animationName=s.stopping_lr,c.metronomeState=r[r.StoppingLR]);break;case r[r.StoppingLR]:case r[r.StoppingRL]:case r[r.Stopped]:t.animationName=s.stopped,t.animationPlayState=i.paused,c.metronomeState=r[r.Stopped];break;default:console.log("data-metronome-state invalid")}t.setStyle()})),function t(e){p()(".form-control").off("onblur"),p()(".add-schedule-row").off("click"),p()(".delete-schedule-row").off("click"),p()(".form-control").blur((function(){var n=p()(".form-control").index(this);x.parseControl(n),c.exerciseMarkup=x.toHtml(),t(e)})),p()(".add-schedule-row").click((function(){var n=p()(".add-schedule-row").index(this);x.appendRow(n),c.exerciseMarkup=x.toHtml(),t(e)})),p()(".delete-schedule-row").click((function(){var n=p()(".delete-schedule-row").index(this);x.deleteRow(n),c.exerciseMarkup=x.toHtml(),t(e)}))}(g)}))}]);